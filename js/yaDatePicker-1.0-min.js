(function(f){f.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];f.daysNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];f.prevLink="←";f.nextLink="→";function c(l,p){var j=l.getMonth();var q=l.getDate();var r=l.getFullYear();var o=p.split(""),k;for(var n=0;n<o.length;n++){k=o[n];switch(o[n]){case"d":k=(q<10)?("0"+q):q;break;case"m":k=(j<9)?("0"+(1+j)):(1+j);break;case"y":k=(""+r).substr(2,2);break;case"Y":k=r;break}o[n]=k}return o.join("")}function h(i,j){return new Date(i.getFullYear(),i.getMonth()+j,0)>new Date()}function d(i){return new Date(i.getFullYear(),i.getMonth(),i.getDate())}function e(k){var j=[];var m=f.daysNames;for(var l=m.length-1;l>=0;l--){if(l>=k){j.unshift(m[l])}else{j.push(m[l])}}return j}function b(i){f("#"+i.id).slideUp(200)}function a(k){var A=new Date();var v=k.currentDate.getMonth();var u=e(k.firstDay);var m="";for(var y=0;y<7;y++){m+='<td class="@@-cell">'+u[y]+"</td>"}var l='<tr class="@@-days">'+m+"</tr>";var j=new Date(k.currentDate);j.setDate(0);j.setDate(j.getDate()+k.firstDay-j.getDay());if(j.getMonth()==v){j.setDate(j.getDate()-7)}var o,p,z,n;for(var q=0,B=0;q<6;q++){m="";for(y=0;y<7;y++){var C=j.getDate();var x=j.getDay();o=(j.getMonth()==v)?" @@-on-month":" @@-off-month";p=(x==0||x==6)?" @@-weekend":"";z=((!k.allowPast&&j<=A)||(k.endDate!=-1&&j>k.endDate))?" @@-no-day":" @@-yes-day";n=j.getTime()==k.selectedDate.getTime()?" @@-selected-day":"";j.setDate(j.getDate()+1);m+='<td class="@@-cell'+o+p+z+n+'">'+C+"</td>"}l+='<tr class="@@-week">'+m+"</tr>"}var r="";if(k.navigation){var s='<div class="@@-prev-link">'+f.prevLink+"</div>";var t='<div class="@@-next-link">'+f.nextLink+"</div>";if(!k.allowPast&&!h(k.currentDate,0)){s=""}if(k.endDate!=-1&&k.endDate.getMonth()==v){t=""}r='<tr class="@@-links"><td colspan="1">'+s+'</td><td colspan="5"><div class="@@-current">'+f.monthNames[k.currentDate.getMonth()]+" "+k.currentDate.getFullYear()+'</div></td><td colspan="1">'+t+"</td></tr>"}return('<table cellpadding="0" cellspacing="0">'+r+l+"</table>").replace(/@{2}/gi,k.theme)}function g(m,j){if(!j.allowPast){if(!h(j.currentDate,1)){var i=new Date(j.currentDate);i.setMonth(i.getMonth()+1);j.currentDate=i}}var k=a(j);var l=f("#"+j.id);if(l.length==0){l=f('<div id="'+j.id+'" class="'+j.theme+'"/>');if(j.inline){m.empty().append(l.addClass("inline"))}else{m.after(l.css({position:"absolute",display:"none"}))}}l.html(k);f("."+j.theme+"-links [class*=-link]",l).hover(function(){f(this).addClass(j.theme+"-link-hover")},function(){f(this).removeClass(j.theme+"-link-hover")}).click(function(o){o.stopPropagation();var n=new Date(j.currentDate);n.setMonth(n.getMonth()+(f(this).attr("class").indexOf("-prev-link")!=-1?-1:1));j.currentDate=n;g(m,j)});f("."+j.theme+"-yes-day",l).hover(function(){f(this).addClass(j.theme+"-cell-hover")},function(){f(this).removeClass(j.theme+"-cell-hover")}).click(function(){var o=f(this);var p=o.html();var n=new Date(j.currentDate);if(o.hasClass(j.theme+"-off-month")){n.setMonth(n.getMonth()+(p>15?-1:1))}n.setDate(p);j.currentDate=n;j.selectedDate=n;if(!j.inline){m.val(c(n,j.format));b(j)}g(m,j);if(j.onSelect){j.onSelect(n)}})}f.fn.attachDatePicker=function(i){return this.each(function(){var p=f(this);var l=d(new Date());var m=f.extend({},{inline:false,firstDay:0,navigation:true,allowPast:true,endDate:-1,theme:"dp",format:"d.m.Y",onSelect:function(q){}},i);m.id="dp-"+f("div[id^=dp-]").length;m.currentDate=l;m.selectedDate=l;if(!m.allowPast){m.selectedDate.setDate(l.getDate()+1)}var k=m.endDate;if(k!=-1){if(typeof k=="number"){var o=new Date(l);o.setDate(o.getDate()+k);m.endDate=o}else{if(!(k instanceof Date)){m.endDate=-1}}}g(p,m);if(!m.inline){var n=function(q){q.stopPropagation();f("#"+m.id).css({left:p.offset().left,top:p.offset().top+p.outerHeight(false)}).slideDown(200);f("div[id^=dp-]").not(".inline").not("#"+m.id).slideUp(200)};var j=function(q){q.stopPropagation();b(m)};p.focus(n).click(n);f(document).click(j)}})}})(jQuery);